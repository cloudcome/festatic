/*!
 * jquery.storage.js
 * @author 云淡然 http://qianduanblog.com
 * @version 1.0
 * 2013年10月2日1:41:04
 */
!function(e){function t(){return"local"==o.type?window.localStorage:window.sessionStorage}function r(t){return"string"==e.type(t)||"number"==e.type(t)}function n(t,r,n){var o,s,f={key:r,fn:n};u.push(f),e.isEmptyObject(i)&&(i=t),s=i,o=function(t){var r,n=0,o=u.length;for(i=e.storage();o>n;n++)r=u[n],e.inArray(t.key,r.key)>-1&&r.fn(t,s,i)},a||(a=1,window.addEventListener("storage",o,!1))}var o={type:"local"},i={},u=[],a=0;e.extend({storage:function(){var o,i=arguments,u=i.length,a={},s=t(),f=0,l=0;if(0==u){for(l=s.length;l>f;f++)a[s.key(f)]=s.getItem(s.key(f));return a}if(1==u&&r(i[0]))return s.getItem(i[0]);if(1==u&&e.isArray(i[0])){for(l=i[0].length;l>f;f++)o=i[0][f],r(o)&&(a[o]=s.getItem(o));return a}if(2==u&&r(i[0])&&r(i[1]))return s.setItem(i[0],i[1]),!0;if(1==u&&"object"==e.type(i[0])){for(f in i[0])o=i[0][f],r(f)&&r(o)&&s.setItem(f,o);return!0}if(2==u&&r(i[0])&&null===i[1])return s.removeItem(i[0]),!0;if(2==u&&e.isArray(i[0])&&null===i[1]){for(l=i[0].length;l>f;f++)o=i[0][f],r(o)&&s.removeItem(o);return!0}return 1==u&&null===i[0]?(s.clear(),!0):void(2==u&&r(i[0])&&e.isFunction(i[1])?n(e.storage(),[i[0]],i[1]):2==u&&e.isArray(i[0])&&e.isFunction(i[1])&&n(e.storage(),i[0],i[1]))}}),e.storage.defaults=o}(jQuery);